import{r as t,c as e}from"./App.js";const n="pk_test_51Ls3YjJiFO7cOn9i5GWxoJdBk5iN6FnUgdaHgD2wBxN7bqVFfcMKXQI4v86fwqhxe4b8CjYOKZNjg2VrcU2yply200OxYQlFCt";async function o(){const t=document.getElementById("checkout");if(t&&t instanceof HTMLButtonElement){t.disabled=!0,t.style.cursor="not-allowed",t.style.opacity="0.5",t.textContent="Redirecting to Stripe... HOLD YOUR HORSES!";try{const t=await fetch("/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({line_items:(console.log("createLineItems",e),Object.keys(e).map((t=>{const n=Number(t);return{price_data:{currency:"usd",product_data:{name:e[n].product.title,images:[e[n].product.images[0]]},unit_amount:100*e[n].product.price},quantity:e[n].quantity}}))),mode:"payment",success_url:"http://localhost:3001/success",cancel_url:"http://localhost:3001/cancel"})}),o=await t.json();console.log(o);const c=await async function(){return(await import("./stripe.esm-31330026.js")).loadStripe(n)}();await(c?.redirectToCheckout({sessionId:o.session.id}))}catch(e){console.error("error",e),t.disabled=!1,t.style.cursor="pointer",t.style.opacity="1",t.textContent="Hmmm... Something went wrong. Try again?"}}}function c(){t({component:`\n    <div>\n      <h1>Checkout</h1>\n      ${Object.keys(e).map((t=>{const n=Number(t);return`\n      <div style="margin-bottom: 1rem;">\n      <a href="/product/${e[n].product.id}">\n        <img src="${e[n].product.images[0]}" />\n        <h2>${e[n].product.title}</h2>\n      </a>\n        <span>$${e[n].product.price}</span>\n        <span>Quantity: ${e[n].quantity}</span>\n      </div>\n    `})).join("")}\n      <p>Total: ${Object.keys(e).reduce(((t,n)=>t+e[Number(n)].product.price*e[Number(n)].quantity),0)}</p>\n      <button id="checkout">Checkout (Redirect to Stripe)</button>\n    </div>\n`,callback:()=>document?.getElementById("checkout")?.addEventListener("click",o)})}export{c as default};
