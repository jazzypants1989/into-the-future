let t=[];const e=async()=>{const t=await fetch("https://dummyjson.com/products");if(!t.ok)return alert("HTTP-Error: "+t.status),console.error(t),p("badFetch",t.status);return await t.json()};async function n(){if(t.length>0)return console.trace("products already loaded"),t;const n=await e();return t=n.products,t}async function o(e){return t=await n(),t.find((t=>t.id===Number(e)))}async function r(){const t=JSON.parse(localStorage.getItem("cart")||"{}");document.title="Cart";const e=await n();if(0===Object.keys(t).length)s({component:"\n          <h1>Cart</h1>\n          <p>Your cart is empty. Go buy some weird stuff!</p>\n          "});else{s({component:`\n          <h1>Cart</h1>\n          ${Object.keys(t).map((n=>{const o=e.find((t=>t.id===Number(n)));return o?`\n            <div class="product">\n              <img src="${o?.thumbnail}" alt="${o?.title}" />\n              <h2>${o?.title}</h2>\n              <p>$${o?.price}</p>\n              <p>Quantity: ${t[n].quantity}</p>\n              <button class="remove-from-cart" id="${o?.id}">Remove from cart</button>\n            </div>\n            `:p("badID",n)})).join("")}\n          `,callback:u})}}var a=Object.freeze({__proto__:null,default:r});let c=JSON.parse(localStorage.getItem("cart")||"{}");function i(){const t=document.querySelector("#cart-count"),e=document.querySelector("#cart-total");if(!t||!e)throw new Error("No cart count or cart amount found");t.innerText=Object.keys(c).length.toString(),e.innerText="$"+Object.values(c).map((t=>t.product.price*t.quantity)).reduce(((t,e)=>t+e),0).toFixed(2)}function s({component:t,callback:e}){!function(){if(!l||!m)return;m.style.viewTransitionName="activeImage"}(),function({skipTransition:t=!1,classNames:e=[],updateDOM:n=(()=>{})}){if(t||!document.startViewTransition){const t=Promise.resolve(n());return{ready:Promise.reject(Error("View transitions unsupported")),updateCallbackDone:t,finished:t}}document.startViewTransition(n)}({updateDOM:()=>{if(!b)throw new Error("No main element found");t||p("error","No component provided"),b.innerHTML=t,b.scrollTop=0,function(){if(!l)return;const t=document.querySelector("img");t&&(t.classList.add("activeImage"),t.style.viewTransitionName="activeImage")}(),e&&e()}})}async function d(){const t=await n();Array.from(document.querySelectorAll(".add-to-cart")).forEach((e=>{e.alreadyAdded||(e.alreadyAdded=!0,e.addEventListener("click",(e=>{const n=e.target.id,o=t.find((t=>t.id===Number(n)));o?function(t){c[t.id]?c[t.id].quantity++:c[t.id]={quantity:1,product:t},localStorage.setItem("cart",JSON.stringify(c)),alert(`${t.title} added to cart!`),i()}(o):p("badID",n)})))}))}async function u(){const t=await n();Array.from(document.querySelectorAll(".remove-from-cart")).forEach((e=>{e.alreadyAdded||(e.alreadyAdded=!0,e.addEventListener("click",(e=>{const n=e.target;if(!n||!function(t){return"alreadyAdded"in t}(n))return;const o=n.id,a=t.find((t=>t.id===Number(o)));a?function(t){c[t.id].quantity--,0===c[t.id].quantity&&delete c[t.id],localStorage.setItem("cart",JSON.stringify(c)),alert(`${t.title} removed from cart!`),i(),r()}(a):p("badID",o)})))}))}let l=!1,m=null;function p(t,e){switch(document.title="404",t){case"badID":s({component:`<h1>404</h1><h2>Sorry buddy, but I don't think we have a product with id #${e}.</h2>`});break;case"badFetch":s({component:"<h1>404</h1><h2>Dang, either the server is down or someone misspelled a URL. Whatever it is, it's probably Jesse's fault.</h2>"});break;case"error":s({component:`<h1>That's Weird!</h1><h4>${e}</h4>`});break;default:s({component:`<h1>404</h1><h2>Huh, you're at ${location.pathname}, but you really shouldn't be... ðŸ¤” </h2>`})}}document.addEventListener("click",(t=>{const e=t.target;if("IMG"===e.tagName||e.parentNode instanceof HTMLAnchorElement)if(l=!0,"IMG"===e.tagName)m=e;else{const t=e.parentNode?.querySelector("img");t&&(m=t)}else l=!1}));const h={home:()=>import("./Home-11012667.js"),about:()=>import("./About-033a6b9c.js"),products:()=>import("./Products-294aa5b9.js"),productpage:()=>import("./ProductPage-9628643f.js"),cart:()=>Promise.resolve().then((function(){return a})),checkout:()=>import("./Checkout-2a759293.js"),success:()=>import("./Success-1676491f.js"),events:()=>import("./Events-b24be976.js")},f=[{path:"/",component:"home"},{path:"/about",component:"about"},{path:"/products",component:"products"},{path:"/product",component:"productpage",dynamic:!0},{path:"/cart",component:"cart"},{path:"/checkout",component:"checkout"},{path:"/success",component:"success"},{path:"/events",component:"events"}];async function y(t){const e=f.find((e=>e.path.split("/")[1]===t.split("/")[1]));if(!e)return void p("404",t);const n=await h[e.component]();if(e.dynamic){const e=t.split("/")[t.split("/").length-1];return n.default(e)}return n.default()}function g(t){return`\n            <div class="product" id="${t.id}">\n              <a href=/product/${t.id}>\n                <img src="${t.thumbnail}" alt="${t.title}" loading="lazy"/>\n              <h2>${t.title}</h2>\n              </a>\n              <p>${t.description}</p>\n              <p>$${t.price}</p>\n              <button class="add-to-cart" id="${t.id}">Add to cart</button>\n              <a href="/">Back to home</a>\n            </div>\n            `}const w=document.querySelector("#search");async function v(){const t=await n(),e=w.value;document.title="Search Page for "+e;const o=t.filter((t=>t.title.toLowerCase().includes(e.toLowerCase())));if(0===o.length)s({component:"<h1>Products</h1><p>No Products Found</p>"});else{s({component:`<h1>Products</h1>${o.map(g).join("")}`,callback:d})}}const b=document.querySelector(".main");async function S(t){if(function(t){if(!t)return;return!t.canIntercept||t.hashChange||t.downloadRequest||t.formData}(t))return void console.log("shouldNotIntercept");const e=t?t.destination.url:location.href,n=new URL(e),o=n.pathname,r=document.querySelector("nav"),a="flex"===r?.style.display,c=window.matchMedia("(max-width: 768px)");if(a&&c.matches&&(r.style.display="none"),t&&o===location.pathname)return void t.intercept({async handler(){alert("We're already here! Silly Billy! *honk honk* ðŸ¤¡ (that's you)"),t.preventDefault()}});const i=new URLSearchParams(n.search).get("search"),d=function(){const t=document.createElement("div");return t.classList.add("spinner"),t}(),u=b?.innerHTML||"";if(function(t,e,n){setTimeout((()=>{if(t===b?.innerHTML){if(!b)return;document.title="Loading...";const t=document.createElement("h1");t.textContent="Loading...",s({component:t.outerHTML+e.outerHTML})}}),n)}(u,d,300),i&&w instanceof HTMLInputElement)return w.value=i,v();t?t.intercept({scroll:"manual",async handler(){t.signal.onabort=()=>{b&&(b.innerHTML=u||"")};try{await y(o)}catch(t){if(console.error("error",t),!b)return;p("error","Something went wrong. Super helpful, I know.")}}}):await y(o)}window.navigation.addEventListener("navigate",S);const k=document.querySelector("#toggleTheme"),N=localStorage.getItem("theme");i(),document.body.className=N||"dark",k?.addEventListener("click",(()=>{const t=localStorage.getItem("theme")||"dark",e="dark"===t?"purple":"purple"===t?"green":"dark";localStorage.setItem("theme",e),document.body.className=e})),function(){if(!w)throw new Error("No search element found");w.addEventListener("input",v)}(),function(){const t=document.querySelector("#hamburger");if(!t)throw new Error("Hamburger menu not found");t.addEventListener("click",(()=>{const t=document.querySelector("nav");if(!t)throw new Error("Nav element not found");const e=document.querySelector("nav ul");if(!e)throw new Error("Nav ul element not found");const n=window.innerHeight;"flex"===t.style.display?(e.style.height="0px",e.style.fontSize="initial",setTimeout((()=>{t.style.display="none"}),480)):(t.style.display="flex",setTimeout((()=>{e.style.height=n+"px",e.style.fontSize="2rem"}))),window.addEventListener("resize",(()=>{window.innerWidth>768?(t.style.display="flex",e.style.height="initial",e.style.fontSize="initial"):(t.style.display="none",e.style.height="0px",e.style.fontSize="initial")}))}))}(),S();export{p as N,g as P,o as a,d as b,c,n as g,s as r};
